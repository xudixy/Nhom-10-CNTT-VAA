{"ast":null,"code":"var _jsxFileName = \"/Users/hoanggiakiet/Documents/EcommerceProject/orderControllerAdmin/front-end/admin-dashboard/src/pages/OrdersPage.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { Box, Button, Snackbar, Alert } from '@mui/material';\nimport axios from 'axios';\nimport OrderList from '../components/orders/OrderList';\nimport OrderForm from '../components/orders/OrderForm';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst OrdersPage = () => {\n  _s();\n  const [orders, setOrders] = useState([]);\n  const [open, setOpen] = useState(false);\n  const [formData, setFormData] = useState({\n    customerName: '',\n    product: '',\n    quantity: '',\n    status: ''\n  });\n  const [editId, setEditId] = useState(null);\n  const [error, setError] = useState('');\n  const [snackbar, setSnackbar] = useState({\n    open: false,\n    message: '',\n    severity: 'success'\n  });\n  const fetchOrders = async () => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${localStorage.getItem('token')}`\n      };\n      const response = await axios.get('http://localhost:5000/api/orders', {\n        headers\n      });\n      setOrders(response.data);\n    } catch (error) {\n      console.error('Error fetching orders:', error);\n      setError('Không thể tải danh sách đơn hàng');\n    }\n  };\n  useEffect(() => {\n    fetchOrders();\n  }, []);\n  const handleSubmit = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        setError('Không tìm thấy token xác thực. Vui lòng đăng nhập lại.');\n        return;\n      }\n      const config = {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      };\n      if (editId) {\n        await axios.put(`http://localhost:5000/api/orders/${editId}`, formData, config);\n        setSnackbar({\n          open: true,\n          message: 'Cập nhật đơn hàng thành công',\n          severity: 'success'\n        });\n      } else {\n        await axios.post('http://localhost:5000/api/orders', {\n          ...formData,\n          status: 'Chờ xác nhận'\n        }, config);\n        setSnackbar({\n          open: true,\n          message: 'Thêm đơn hàng thành công',\n          severity: 'success'\n        });\n      }\n      fetchOrders();\n      handleClose();\n    } catch (error) {\n      console.error('Error saving order:', error);\n      setError('Có lỗi xảy ra khi lưu đơn hàng');\n      setSnackbar({\n        open: true,\n        message: 'Có lỗi xảy ra khi lưu đơn hàng',\n        severity: 'error'\n      });\n    }\n  };\n  const handleConfirm = async id => {\n    try {\n      const token = localStorage.getItem('token');\n      const config = {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      };\n      await axios.put(`http://localhost:5000/api/orders/${id}/confirm`, {}, config);\n      fetchOrders();\n      setSnackbar({\n        open: true,\n        message: 'Đơn hàng đã được xác nhận',\n        severity: 'success'\n      });\n    } catch (error) {\n      console.error('Error confirming order:', error);\n      setError('Có lỗi xảy ra khi xác nhận đơn hàng');\n      setSnackbar({\n        open: true,\n        message: 'Có lỗi xảy ra khi xác nhận đơn hàng',\n        severity: 'error'\n      });\n    }\n  };\n  const handleEdit = order => {\n    setFormData({\n      customerName: order.customerName || '',\n      product: order.product || '',\n      quantity: order.quantity || '',\n      status: order.status || ''\n    });\n    setEditId(order._id);\n    setOpen(true);\n  };\n  const handleDelete = async id => {\n    if (window.confirm('Bạn có chắc muốn xóa đơn hàng này?')) {\n      try {\n        const headers = {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        };\n        await axios.delete(`http://localhost:5000/api/orders/${id}`, {\n          headers\n        });\n        fetchOrders();\n      } catch (error) {\n        console.error('Error deleting order:', error);\n        setError('Không thể xóa đơn hàng');\n      }\n    }\n  };\n  const handleClose = () => {\n    setOpen(false);\n    setFormData({\n      customerName: '',\n      product: '',\n      quantity: '',\n      status: ''\n    });\n    setEditId(null);\n    setError('');\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      variant: \"contained\",\n      onClick: () => setOpen(true),\n      children: \"Th\\xEAm \\u0111\\u01A1n h\\xE0ng\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(OrderList, {\n      orders: orders,\n      onEdit: handleEdit,\n      onDelete: handleDelete,\n      onConfirm: handleConfirm // Thêm hàm xác nhận\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(OrderForm, {\n      open: open,\n      onClose: handleClose,\n      formData: formData,\n      setFormData: setFormData,\n      onSubmit: handleSubmit,\n      editId: editId\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n      open: !!error || snackbar.open,\n      autoHideDuration: 6000,\n      onClose: () => setError(''),\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        severity: snackbar.severity || 'error',\n        onClose: () => setError(''),\n        children: error || snackbar.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 5\n  }, this);\n};\n_s(OrdersPage, \"3xI9E+Y+/uausYCrrMmr+kLoYSg=\");\n_c = OrdersPage;\nexport default OrdersPage;\nvar _c;\n$RefreshReg$(_c, \"OrdersPage\");","map":{"version":3,"names":["useState","useEffect","Box","Button","Snackbar","Alert","axios","OrderList","OrderForm","jsxDEV","_jsxDEV","OrdersPage","_s","orders","setOrders","open","setOpen","formData","setFormData","customerName","product","quantity","status","editId","setEditId","error","setError","snackbar","setSnackbar","message","severity","fetchOrders","headers","Authorization","localStorage","getItem","response","get","data","console","handleSubmit","token","config","put","post","handleClose","handleConfirm","id","handleEdit","order","_id","handleDelete","window","confirm","delete","children","variant","onClick","fileName","_jsxFileName","lineNumber","columnNumber","onEdit","onDelete","onConfirm","onClose","onSubmit","autoHideDuration","_c","$RefreshReg$"],"sources":["/Users/hoanggiakiet/Documents/EcommerceProject/orderControllerAdmin/front-end/admin-dashboard/src/pages/OrdersPage.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Box, Button, Snackbar, Alert } from '@mui/material';\nimport axios from 'axios';\nimport OrderList from '../components/orders/OrderList';\nimport OrderForm from '../components/orders/OrderForm';\n\nconst OrdersPage = () => {\n  const [orders, setOrders] = useState([]);\n  const [open, setOpen] = useState(false);\n  const [formData, setFormData] = useState({\n    customerName: '',\n    product: '',\n    quantity: '',\n    status: ''\n  });\n  const [editId, setEditId] = useState(null);\n  const [error, setError] = useState('');\n  const [snackbar, setSnackbar] = useState({ open: false, message: '', severity: 'success' });\n\n  const fetchOrders = async () => {\n    try {\n      const headers = {\n        Authorization: `Bearer ${localStorage.getItem('token')}`\n      };\n      const response = await axios.get('http://localhost:5000/api/orders', { headers });\n      setOrders(response.data);\n    } catch (error) {\n      console.error('Error fetching orders:', error);\n      setError('Không thể tải danh sách đơn hàng');\n    }\n  };\n\n  useEffect(() => {\n    fetchOrders();\n  }, []);\n\n  const handleSubmit = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        setError('Không tìm thấy token xác thực. Vui lòng đăng nhập lại.');\n        return;\n      }\n\n      const config = {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      };\n\n      if (editId) {\n        await axios.put(`http://localhost:5000/api/orders/${editId}`, formData, config);\n        setSnackbar({ open: true, message: 'Cập nhật đơn hàng thành công', severity: 'success' });\n      } else {\n        await axios.post('http://localhost:5000/api/orders', { ...formData, status: 'Chờ xác nhận' }, config);\n        setSnackbar({ open: true, message: 'Thêm đơn hàng thành công', severity: 'success' });\n      }\n\n      fetchOrders();\n      handleClose();\n    } catch (error) {\n      console.error('Error saving order:', error);\n      setError('Có lỗi xảy ra khi lưu đơn hàng');\n      setSnackbar({ open: true, message: 'Có lỗi xảy ra khi lưu đơn hàng', severity: 'error' });\n    }\n  };\n\n  const handleConfirm = async (id) => {\n    try {\n      const token = localStorage.getItem('token');\n      const config = {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      };\n      await axios.put(`http://localhost:5000/api/orders/${id}/confirm`, {}, config);\n      fetchOrders();\n      setSnackbar({ open: true, message: 'Đơn hàng đã được xác nhận', severity: 'success' });\n    } catch (error) {\n      console.error('Error confirming order:', error);\n      setError('Có lỗi xảy ra khi xác nhận đơn hàng');\n      setSnackbar({ open: true, message: 'Có lỗi xảy ra khi xác nhận đơn hàng', severity: 'error' });\n    }\n  };\n\n  const handleEdit = (order) => {\n    setFormData({\n      customerName: order.customerName || '',\n      product: order.product || '',\n      quantity: order.quantity || '',\n      status: order.status || ''\n    });\n    setEditId(order._id);\n    setOpen(true);\n  };\n\n  const handleDelete = async (id) => {\n    if (window.confirm('Bạn có chắc muốn xóa đơn hàng này?')) {\n      try {\n        const headers = {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        };\n        await axios.delete(`http://localhost:5000/api/orders/${id}`, { headers });\n        fetchOrders();\n      } catch (error) {\n        console.error('Error deleting order:', error);\n        setError('Không thể xóa đơn hàng');\n      }\n    }\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n    setFormData({\n      customerName: '',\n      product: '',\n      quantity: '',\n      status: ''\n    });\n    setEditId(null);\n    setError('');\n  };\n\n  return (\n    <Box>\n      <Button variant=\"contained\" onClick={() => setOpen(true)}>\n        Thêm đơn hàng\n      </Button>\n\n      <OrderList \n        orders={orders}\n        onEdit={handleEdit}\n        onDelete={handleDelete}\n        onConfirm={handleConfirm} // Thêm hàm xác nhận\n      />\n\n      <OrderForm\n        open={open}\n        onClose={handleClose}\n        formData={formData}\n        setFormData={setFormData}\n        onSubmit={handleSubmit}\n        editId={editId}\n      />\n\n      <Snackbar \n        open={!!error || snackbar.open} \n        autoHideDuration={6000} \n        onClose={() => setError('')}\n      >\n        <Alert severity={snackbar.severity || 'error'} onClose={() => setError('')}>\n          {error || snackbar.message}\n        </Alert>\n      </Snackbar>\n    </Box>\n  );\n};\n\nexport default OrdersPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}